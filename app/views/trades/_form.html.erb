<%= form_with model: @trade, class: "space-y-6" do |form| %>
  <% if @trade.errors.any? %>
    <div class="bg-red-50 border border-red-200 rounded-xl p-4">
      <div class="flex items-start gap-3">
        <svg class="w-5 h-5 text-red-500 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
        </svg>
        <div>
          <p class="font-medium text-red-800">Please fix the following errors:</p>
          <ul class="mt-2 text-sm text-red-700 list-disc list-inside">
            <% @trade.errors.full_messages.each do |message| %>
              <li><%= message %></li>
            <% end %>
          </ul>
        </div>
      </div>
    </div>
  <% end %>

  <div class="grid md:grid-cols-2 gap-6">
    <!-- Platform -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Platform</label>
      <%= form.select :platform,
          options_for_select(@available_platforms.map { |p| [p.titleize, p] }, @trade.platform),
          {},
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>

    <!-- Trade Type -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Trade Type</label>
      <%= form.select :trade_type,
          options_for_select([["Buy", "buy"], ["Sell", "sell"]], @trade.trade_type),
          {},
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>

    <!-- Status -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Status</label>
      <%= form.select :status,
          options_for_select([["Completed", "COMPLETED"], ["Cancelled", "CANCELLED"]], @trade.status),
          {},
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>

    <!-- Counterparty -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Counterparty</label>
      <%= form.text_field :counterparty,
          placeholder: "Enter counterparty name or identifier",
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>
  </div>

  <hr class="border-slate-200">

  <div class="grid md:grid-cols-2 gap-6">
    <!-- Cryptocurrency -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Cryptocurrency</label>
      <%= form.text_field :cryptocurrency,
          placeholder: "e.g., USDT, BTC, ETH",
          required: true,
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>

    <!-- Crypto Amount -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Crypto Amount</label>
      <%= form.number_field :crypto_amount,
          placeholder: "e.g., 1000",
          step: "0.00000001",
          min: "0",
          required: true,
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>

    <!-- Local Currency -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Local Currency</label>
      <%= form.text_field :local_currency,
          placeholder: "e.g., USD, EUR, GBP",
          required: true,
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>

    <!-- Local Currency Amount -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Local Currency Amount</label>
      <%= form.number_field :local_currency_amount,
          placeholder: "e.g., 1050",
          step: "0.01",
          min: "0",
          required: true,
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>

    <!-- Market Value -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Market Value (in local currency)</label>
      <%= form.number_field :market_value,
          placeholder: "e.g., 1000",
          step: "0.01",
          min: "0",
          required: true,
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
      <p class="mt-1 text-xs text-slate-500">The market value of the crypto at the time of trade</p>
    </div>

    <!-- Trading Fee -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Trading Fee</label>
      <%= form.number_field :trading_fee,
          placeholder: "e.g., 0",
          step: "0.00000001",
          min: "0",
          value: @trade.trading_fee || 0,
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>

    <!-- Date -->
    <div>
      <label class="block text-sm font-medium text-slate-700 mb-2">Trade Date</label>
      <%= form.datetime_local_field :time_created,
          required: true,
          class: "w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" %>
    </div>
  </div>

  <hr class="border-slate-200">

  <div class="flex items-center justify-end gap-4">
    <%= link_to "Cancel", trades_path, class: "px-6 py-3 text-slate-700 hover:text-slate-900 font-medium" %>
    <%= form.submit @trade.new_record? ? "Create Trade" : "Update Trade",
        class: "px-6 py-3 bg-orange-500 hover:bg-orange-600 text-white font-semibold rounded-lg transition-colors cursor-pointer" %>
  </div>
<% end %>
